<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<rfc category="info" docName="draft-ietf-bier-ipv6-requirements-07"
     ipr="trust200902">
  <front>
    <title abbrev="BIER IPv6 Requirements">BIER IPv6 Requirements</title>

    <author fullname="Mike McBride" initials="M" surname="McBride">
      <organization>Futurewei</organization>

      <address>
        <email>michael.mcbride@futurewei.com</email>
      </address>
    </author>

    <author fullname="Jingrong Xie" initials="J" surname="Xie">
      <organization>Huawei</organization>

      <address>
        <email>xiejingrong@huawei.com</email>
      </address>
    </author>
    
       <author fullname="Xuesong" initials="X" surname="Geng">
      <organization>Huawei</organization>

      <address>
        <email>gengxuesong@huawei.com</email>
      </address>
    </author>

    <author fullname="Senthil Dhanaraj" initials="S" surname="Dhanaraj">
      <organization>Huawei</organization>

      <address>
        <email>senthil.dhanaraj@huawei.com</email>
      </address>
    </author>

    <author fullname="Rajiv Asati" initials="R" surname="Asati">
      <organization>Cisco</organization>

      <address>
        <email>rajiva@cisco.com</email>
      </address>
    </author>
    
       <author fullname="Yongqing Zhu" initials="Y" surname="Zhu">
      <organization>China Telecom</organization>

      <address>
        <email>zhuyq8@chinatelecom.cn</email>
      </address>
    </author>
 
     <author fullname="Gyan Mishra" initials="G. " surname="Mishra">
      <organization>Verizon Inc.</organization>
      <address>
        <email>gyan.s.mishra@verizon.com</email>
      </address>
    </author>
       
        <author fullname="Zhaohui Zhang" initials="Z" surname="Zhang">
      <organization>Juniper</organization>

      <address>
        <email>zzhang@juniper.net</email>
      </address>
    </author>

    <date day="4" month="September" year="2020"/>

    <abstract>
      <t>There have been several proposed solutions with BIER being used in IPv6. But there
      hasn't been a document which describes the problem and lists the requirements. 
      The goal of this document is to describe the general BIER IPv6 encapsulation problem, 
      summarize the encapsulation modes of the proposed solutions, detail solution requirements, 
      and assist the working group in the development of acceptable solutions.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>Bit Index Explicit Replication (BIER) <xref target="RFC8279"/> is an
      architecture that provides optimal multicast forwarding, without
      requiring intermediate routers to maintain per-flow state, through the
      use of a multicast-specific BIER header. <xref target="RFC8296"/>
      defines two types of BIER encapsulation: one is
      BIER MPLS encapsulation for MPLS environments,
	  the other is non-MPLS BIER encapsulation to run without MPLS.
	  This document describes using
      BIER in non-MPLS IPv6 environments. We explain the requirements of
      transporting IPv4/IPv6 multicast overlay payload through an IPv6 network
	  underlay using BIER. The solutions may require the use of IPv6
	  forwarding plane and may include IPv6 encapsulation and/or generic
	  IPv6 tunnelling. 
      </t>

      <section anchor="requirements-language" title="Requirements Language">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <xref
        target="RFC2119">RFC 2119</xref>.</t>
      </section>

      <section anchor="terminology" title="Terminology">
        <t><list style="symbols">
            <t>BIER: Bit Index Explicit Replication. Provides optimal
            multicast forwarding through adding a BIER header and removing
            state in intermediate routers.</t>

            <t>BUM: Broadcast, Unknown Unicast, Multicast. Term used to
            describe the three types of Ethernet modes that will be forwarded
            to multiple destinations</t>
          </list></t>
      </section>
    </section>

    <section title="Problem Statement">
      
      <t>The problem is how to transport BUM packets using BIER technology in an non-MPLS IPv6 environment.
      With IPv6 encapsulation increasingly used for unicast services like VPN or L2VPN,
      It may also be desired to have BIER deployments, for multicast services such as MVPN, using IPv6 encapsulation. On the other hand, since BIER has its own
	  encapsulation, IPv6 encapsulation is not required, even though
	  IPv6 encapsulation (native or GRE/UDP-like) may be used
	  to transport BIER packets over some BIER-incapable routers.
<!--
      The challenge, in a non MPLS BIER environment with an IPv6 data plane, is that the L2.5 label stack, which includes the 
      encoded BIER header, is now not present. The problem therefore is how, and where, to encode 
      the BIER Header in a Layer 3 IPv6 environment.
-->
      </t>
      
      <t>Below is a simple scenario that needs BIER IPv6-based forwarding:</t>

      <t><figure align="center">
          <artwork><![CDATA[      
      +--------------------------------------------+
      |                                            |
      |                                         +------+
      |                                         | BFER |
  +------+       +-------+       +-----+        +------+
  | BFIR |       |Non-BFR|       | BFR |           |
  +------+       +-------+       +-----+        +------+
      |                                         | BFER |
      |                IPv6 Network             +------+
      |                                            |
      +--------------------------------------------+
      ]]></artwork>
        </figure></t>

      <t>This scenario depicts the need to replicate BIER packets from a
      BFIR to BFERs across an IPv6 Service Provider core. <!--One use case, for BIER in the IPv6 core, is a stateless IP VPN overlay 
      P2MP P-Tree provisioning using MVPN procedures for tree instantiation.-->  
	  Inside the IPv6 network, the BIER header is used to direct the packet from one BFR to the next BFRs, 
	  and either IPv6 header or Ethernet header is used to provide reachability between BFRs.
	  The IPv6 environment may include a variety of link types, may be entirely IPv6, 
	  or may be dual stack. There may be cases where not all routers 
	  are BFR capable in the IPv6 enviroment but still want to deploy BIER.
	  Regardless of the environment, the problem is to deploy BIER in a non-MPLS IPv6 network.
      </t>
      
    </section>

    <section title="Conceptual Models For BIER IPv6 Encapsulation and Forwarding">
    <t>This analysis introduces two conceptual models for BIER in IPv6 networks
     based on the experience and solutions discussed in the IETF community. </t>
    
      <section title="Independent Model">
		<t>The first conceptual model is an Independent Model, where IPv6
		is nothing special to BIER but a transportation means that may be used
		just like other transportioan means, and BIER is nothhing special to
		IPv6 but a payload type just like other payload types. </t>
      <t><figure align="left">
          <artwork><![CDATA[      

      |<<-----(BIER-based multicast overlay)----->>|
      |                                            |
      |<---------(L2.5 BIER(P2MP) Tunnel)--------->|
      |                                            |
      |    +~~~~~~BIER~~~~~~~~+          +BIER+    |
      |   /                    \        /      \   |  
  +------+       +-------+       +-----+   or   +------+
  | BFIR |-------|Non-BFR|-------| BFR |--BIER--| BFER |
  +------+       +-------+       +-----+        +------+

  ------- L2 link 
    
  ~~~~~~~ IPv6(P2P) tunnel
  
  <-----> BIER(P2MP) tunnel
      ]]></artwork>
        </figure></t>
        <t>In this model, an IPv6 tunnel works as a link-layer of BIER, and BIER works as a layer-2.5
		over tunnels or L2 links. Between two BFRs, either a L2 link can be used directly or any tunnel (IPv6 or not) 
		can be used for BIER transport. In the tunnel case, the transmitting BFR adds tunnel encapsulation (e.g. IPv6 header) and 
		the receiving BFR removes the tunnel encapsulation.
        </t>
         
        <t>The general considerations of this model is to keep BIER and IPv6
		independent of each other. The BIER header is not part of the IPv6
		header but comes after the transport
		header (L2 or tunnel header) and before BIER payload.</t>
         
      </section>
      
      <section title="Integrated Model">
      <t>The second conceptual model is an Integrated Model that integrates BIER as part of the IPv6 data plane, 
      making it a "Layer-3 BIER" approach.</t>
      <t><figure align="left">
          <artwork><![CDATA[      

      |<<-----(BIER-based multicast overlay)----->>| 
      |                                            |
      |<----------(L3 BIER(P2MP) tunnel)---------->|
      |                                            |
  +------+       +-------+       +-----+        +------+
  | BFIR |-------|Non-BFR|-------| BFR |--------| BFER |
  +------+       +-------+       +-----+        +------+
  
  ------- L2 link 
  
  <-----> BIER(P2MP) tunnel
      ]]></artwork>
        </figure></t>
        <t>In this model, BIER works as part of the IPv6 data plane. 
        The BFIR and BFERs work as IPv6 (P2MP) tunnel endpoints, and BFRs 
        work as IPv6 segment endpoints. The BIER header is processed on each segment endpoint and there 
        is no decapsulation, or re-encapsulation, on the segment endpoints. </t>
        
        <t>This model typically needs an IPv6 extension header to carry the BIER header. 
        and processing of 
         the BIER header (e.g., the BitString) will be implemented as part of the IPv6 extension header processing. 
         The IPv6 source address is the BIER packet source-origin identifier, and is unchanged through the 
         BIER domain from BFIR to BFERs. </t>
         
         <t>General considerations of this model is to use the IPv6 extension capabilities to enable the BIER function, 
         to smoothly facilitate new requirements that may emerge in an IPv6 network.</t>
         
      </section>

      <!--
     <section title="Encapsulation Approaches">
      <t> A number of BIER-IPv6 encapsulation approaches have been
      investigated by the BIER Working Group.  This section divides these approaches 
      into the two conceptual models.</t>
       
     <t>Independent Model approaches include: </t>
       <t><list style="">
       <t>BIERin6 <xref target="I-D.zhang-bier-bierin6"/>.</t>
       </list></t>
     <t></t>
     <t>Integrated Model approaches include: </t>
       <t><list style="">
       <t>BIER-over-IPv6 <xref target="I-D.pfister-bier-over-ipv6"/>.</t>
       <t>BIERv6 <xref target="I-D.xie-bier-ipv6-encapsulation"/>.</t>
       </list></t>       
     </section>
     -->
    </section>

    <section title="Requirements">
      <t>There are several suggested requirements for BIER IPv6 solutions. </t>
      
      <t>In this document, the requirements are divided into two levels: Mandatory and Optional. 
      The requirement levels are determined based on the following factors: </t>
      <t></t>
       <t>Potential deployment and impact: <list style="">
       <t>If the requirement is required for a feature that is likely to be a potential deployment, the requirement level will be considered mandatory. </t>
       <t>If the impact of not implementing the requirement may block BIER from been deployed, the requirement level will be considered mandatory.</t>
       </list></t>
      <t></t>
       <t>Applicability to one specific model or both models: <list style="">
       <t>If a requirement is common sense from existing BIER practice, and is applicable to both models, the requirement level will be considered mandatory. </t>
       <t>If a requirement is deduced from a specific model, and hasn't been well-known, the requirement level will be considered optional and 
       listed as a topic to further discuss.</t>
       </list></t>         
      <t></t>
      
    <section title="Mandatory Requirements">  
      <t>Considering that these mandatory requirements are all well-known to the working group, and practical in normal deployment, 
      they will be listed without a detailed description.
      </t>
      <section title="L2 Agnostic">
        <t>The solution must be agnostic to the underlying L2 data link type.</t>
      </section>
      
      <section title="Support BIER architecture">
        <t>The solution must support the BIER architecture. </t>

        <t>Suppporting different multicast flow overlays, multiple sub-domains, multi-topologies,
		multiple sets, multiple Bit String Lengths,
		and deterministic ECMP are considered essential functions of BIER and need to be supported.</t>
      </section>

      <section title="Conform to existing IPv6 Spec">
      <t>The proposed encapsulation must conform to the IPv6 specification and 
          guidelines as described in RFC8200. If new extensions to existing
          IPv6 specification are required, it needs to be discussed and 
          approved by the 6man working group.</t>
      </section>

      <section title="Support deployment with Non-BFR routers">
        <t>The solution must support deployments with BIER-incapable routers.
        This is beneficial to the deployment of BIER, especially 
        in early deployments when some routers do not support 
        BIER forwarding but support IPv6 forwarding. </t>
      </section>
      
      <section title="Support OAM">
      <t>BIER OAM should be supported, either directly using existing methods, 
      or by specifying a new method for the same functionality.
      It may be considered essential as part of the BIER architecture in some cases. </t>
      </section>
      
      </section>
      
    <section title="Optional Requirements">
      <t>The requirments in this section are listed as optional, and each requirement is explained with a detailed scenario.
      </t>
      
      <section title="Support Fragmentation">
      <t>There are some cases where the Fragmentation/Assembly function is needed for BIER to work in an IPv6 network. </t>
      <t>For example, a customer IPv6 multicast packet may be 1280 bytes and is required to be transported through an IPv6 network using BIER, 
         and the BIER-MTU of the IPv6 network is about 1300 bytes. Every link of the domain is no less than the IPv6-required 
         1280 bytes <xref target="RFC8200"/>, but is less than the required space to encapsulate the IPv6 c-multicast packet using BIER.
         In this case, it is not the appropriate action for a BFIR to drop the packet and advertise an MTU to the source.
         Instead, the appropriate action for a BFIR is to fragment the packet, and BIER imposing and processing should apply, in 
         sequence, to each fragment <xref target="RFC8296"/>.
      </t>
  		<t>Jeffrey's comment: is c-muilticast for MVPN, or just flow overlay? Would the BFIR impose an additional IPv6 header, besides the "c-muilticast" IPv6 header?
		</t>
      </section>
      
      <section title="Support IPSEC ESP">
      <t>There are some cases where the IPSEC ESP function may be needed to transport c-multicast packets through an IPv6 network with 
      confidentiality using BIER technology.</t>
      <t>A service provider may want to provide additional security SLA to its customer to ensure that the unencrypted c-multicast packet is 
      not altered in the service provider's network. In this case, if the BIER technology is preferred for the multicast service, BIER with IPSEC 
      ESP support may be a candidate solution. On the other hand, the traffic
	  protection may be better provided via IPSEC or MACSEC at multicast flow overlay
	  over and beyond the BIER domain.
      </t>
      </section>
    </section>

    </section>

    <section title="IANA Considerations">
      <t>Some BIER IPv6 encapsulation proposals do not require any action from
      IANA while other proposals require new IPv6 Option
      codepoints from IPv6 sub-registries, new "Next header" values, or
      require new IP Protocol codes. This document, however, does not require
      anything from IANA.</t>
    </section>

    <section title="Security Considerations">
      <t/>
      <t>There are no security issues introduced by this draft.</t>
    </section>

    <section title="Acknowledgement">
      <t/>

      <t>Thanks to Eric Rosen for his listed set of requirements on the
      BIER WG mailing list.</t>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      <?rfc include="reference.RFC.2119"?>

      <?rfc include='reference.RFC.8279'?>

      <?rfc include='reference.RFC.8296'?>

      <?rfc include='reference.RFC.2473'?>

      <?rfc include='reference.RFC.8200'?>

      <?rfc include='reference.I-D.pfister-bier-over-ipv6'?>

      <?rfc include='reference.I-D.zhang-bier-bierin6'?>

      <?rfc include='reference.I-D.xie-bier-ipv6-encapsulation'?>
      
      
      
    </references>
 
    <section title="List of Solutions">
      <t>The following are solutions that have been proposed to solve BIER in
      IPv6 environments. Some solutions propose encoding while others propose
      encapsulation. It is recommended for the wg to evaluate these solutions against
      the requirements listed previously in order to make informed decisions on solution 
      readiness.</t>

      <t>As illustrated in these examples, the BIER header, or the BitString,
      may appear after the L2/tunnel header, in the IPv6 Header, IPv6 Extension Header, IPv6 Payload, or
      IPv6 Tunnel payload.</t>

      <section title="Encode Bitstring in IPv6 destination address">
        <t><figure>
            <artwork align="left"><![CDATA[
   +---------------+-------------------
   |  IPv6 header  | payload
   | (BitString in |
   | DA lower bits)|
   |  Next Header  |
   +---------------+-------------------
          ]]></artwork>
          </figure></t>

        <t>As described in <xref target="I-D.pfister-bier-over-ipv6"/>, The
        information required by BIER is stored in the destination IPv6
        address. The BIER BitString is encoded in the low-order bits of the
        IPv6 destination address of each packet. The high-order bits of the
        IPv6 destination address are used by intermediate routers for unicast
        forwarding, deciding whether a packet is a BIER packet, and if so, to
        identify the BIER Sub-Domain, Set Identifier and BitString length. No
        additional extension or encapsulation header is required. Instead of
        encapsulating the packet in IPv6, the payload is attached to the BIER
        IPv6 header and the IPv6 protocol number is set to the type of the
        payload. If the payload is UDP, the UDP checksum needs to change when
        the BitString in the IPv6 destination address changes.</t>
		<t>Jeffrey's comments - this does not have the encapsulation in
		RFC8296, right? If so, should we consider it at all?
		</t>
      </section>

      <section title="Add BIER header into IPv6 Extension Header ">
        <t><figure>
            <artwork align="left"><![CDATA[
   +---------------+-----------------+-------------------
   |  IPv6 header  | IPv6 Ext header | payload
   |               | (BIER header in |
   |               |  TLV Type = X)  |
   | Next Header   |   Next Header   |
   +---------------+-----------------+-------------------
          ]]></artwork>
          </figure></t>

        <t>According to <xref target="RFC8200"/> In IPv6, optional
        internet-layer information is encoded in separate headers that may be
        placed between the IPv6 header and the upper- layer header in a
        packet. There is a small number of such extension headers, each one
        identified by a distinct Next Header value. An IPv6 packet may carry
        zero, one, or more extension headers, each identified by the Next
        Header field of the preceding header. Extension headers (except for
        the Hop-by-Hop Options header) are not processed, inserted, or deleted
        by any node along a packet's delivery path, until the packet reaches
        the node (or each of the set of nodes, in the case of multicast)
        identified in the Destination Address field of the IPv6 header. The
        Hop-by-Hop Options header is not inserted or deleted, but may be
        examined or processed by any node along a packet's delivery path,
        until the packet reaches the node (or each of the set of nodes, in the
        case of multicast) identified in the Destination Address field of the
        IPv6 header. The Hop-by-Hop Options header, when present, must
        immediately follow the IPv6 header. Its presence is indicated by the
        value zero in the Next Header field of the IPv6 header.</t>

        <t>Two of the currently-defined extension headers are the Hop-by-Hop
        Options header and the Destination Options header which carry a
        variable number of type-length-value (TLV) encoded "options".</t>

        <t>In <xref target="I-D.xie-bier-ipv6-encapsulation"/> an IPv6 BIER
        Destination Option is carried by the IPv6 Destination Option Header
        (indicated by a Next Header value 60). It is initialized in a packet
        sent by an IPv6 BFIR router to inform the following BFR routers in an
        IPv6 BIER domain to replicate to destination BFER routers hop-by-hop.
        BIER is generally a hop-by-hop and one-to-many architecture and it is
        required for a BIER IPv6 encapsulation to include the BIER Header
        ([RFC8296]) as an IPv6 Extension Header, to pilot the hop-by-hop BIER
        replication.</t>

        <t>Hop by hop Options Headers may be considered. The Hop-by-Hop
        Options header is used to carry optional information that may be
        examined and processed by every node along a packet's delivery path.
        The Hop-by-Hop Options header is identified by a Next Header value of
        0 in the IPv6 header.</t>

        <t>Defining New Extension Headers and Options may also be considered,
        if the IPv6 Destination Option Header is not good enough and new
        extension headers can solve the problem better.</t>

        <t>Such proposals may include requests to IANA to allocate a "BIER
        Option" code from "Destination Options and Hop-by-Hop Options", and/or
        a "BIER Option Header" code from "IPv6 Extension Header Types".</t>
      </section>

      <section title="Transport BIER as L2/tunnel payload">
		<t>The BIER architecture and encapsulation specifications assume
		that the BIER header and BIER payload are together treated as the
		payload after a L2 or tunnel header. This model is continued
        in <xref target="I-D.zhang-bier-bierin6"/>, where the BIER header
		and the payload following it are L2 payload when feasible (e.g.
		when two BFRs are directly connected) or IPv6 payload when IPv6
		transport is needed/desired (e.g. when two BFRs are not directly
		connected). This is indicated by either a 0xAB37 Ethertype allocated
		to BIER	or a new IPv6 Next-Header value to be allocated by IANA.</t>
        <t><figure>
            <artwork align="left"><![CDATA[
      +---------------+-----------------+-------------------
      |   Ethernet    |   BIER header   | payload
      |  (ethType =   | (BIFT-id, ...)  |
      |    0xAB37)    |                 |
      |               |  Next Header    |
      +---------------+-----------------+-------------------
          ]]></artwork>
          </figure></t>
        <t><figure>
            <artwork align="left"><![CDATA[
      +---------------+-----------------+-------------------
      |  IPv6 header  | IPv6 Ext header | BIER Hdr + payload
      |               |    (optional)   | as IPv6 payload
      |               |                 |
      | Next Header   | Next Header = X |
      +---------------+-----------------+-------------------
          ]]></artwork>
          </figure></t>
        <t/>
		<t>While not specified in <xref target="I-D.zhang-bier-bierin6"/>,
		any other tunnel types supported by the IPv6 environment could
		be used, e.g. IPv6 GRE/UDP:
		</t>
        <t><figure>
            <artwork align="left"><![CDATA[
   +---------------+-----------------+------------+----------------
   |  IPv6 header  | IPv6 Ext header | GRE header |
   |               |    (optional)   |            | BIER Hdr + 
   |               |                 |            | payload as GRE 
   | Next Header   |   Next Header   |Proto=0xAB37| Payload
   +---------------+-----------------+------------+----------------
          ]]></artwork>
          </figure></t>

        <t><figure>
            <artwork align="left"><![CDATA[
   +---------------+-----------------+------------+----------------
   |  IPv6 header  | IPv6 Ext header | UDP header |
   |               |    (optional)   |            | BIER Hdr + 
   |               |                 |            | payload as UDP 
   | Next Header   |Next Header =UDP | DPort=TBD  | Payload
   +---------------+-----------------+------------+----------------
          ]]></artwork>
          </figure></t>
      </section>
    </section>
    
    
  </back>
</rfc>
